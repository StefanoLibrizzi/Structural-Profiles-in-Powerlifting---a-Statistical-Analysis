---
title: "Structural Profiles in Powerlifting: A Statistical Analysis"
author: "Stefano Librizzi"
date: "2025-10-26"
output:
  pdf_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

# Introduction

Powerlifting is a strength sport that consists of lifting the maximum possible weight in three exercises: **Squat, Bench Press, and Deadlift**. The objective of this analysis is to explore the vast OpenIPF dataset, which collects all competitions held by federations affiliated with the International Powerlifting Federation (IPF), to identify athlete "profiles" based on their specialization in one of the three lifts.

We will use **Cluster Analysis** techniques to group athletes with similar lifting structures and subsequently analyze how these groups differ by nation of origin and performance (measured by Goodlift Points).

The data is updated as of October 25, 2025.

------------------------------------------------------------------------

# 1. Data Preparation: From Raw File to Analysis Dataset

Before starting the analysis, a robust data cleaning and transformation process is necessary. This section documents all the steps taken to convert the raw dataset downloadable on the site Open IPF, here named `openipf_25OTT25.csv`, into the clean file `DC.RData`, making the entire project transparent and reproducible.

## 1.1 Loading Libraries and Data

First, we load all the necessary libraries and the raw dataset.

```{r loading-raw-data}
# Libraries for data manipulation
library(dplyr)
library(tidyr)
library(data.table)
library(lubridate)

# Libraries for visualization
library(ggplot2)
library(patchwork)
library(ggtern)
library(plotly)
library(scales)

# Libraries for statistical analysis
library(cluster)
library(factoextra)
library(FactoMineR)

# Loading the raw dataset using fread for efficiency
openipf <- fread("openipf_25OTT25.csv")

# Converting the Date column to the correct format
openipf$Date <- as.Date(openipf$Date)

# Filtering to include only the most recent competitions (from 2021 onwards)
# to get a current and homogeneous picture of the sport.
Dati <- openipf %>%
  filter(year(Date) > 2020)

head(Dati)
```

***N.B.:** All observations prior to 2021 have been removed from the dataset. It was deemed more interesting to specifically study the situation in recent years, avoiding the analysis being influenced by previous periods that might have different dynamics and athlete distributions.*

## 1.2 Extracting the Best Performance per Athlete

The dataset contains multiple records for the same athlete if they have participated in multiple competitions. To avoid analyzing redundant data and to focus on peak performance, we extract **a single observation for each athlete**: their best absolute performance, measured by the Goodlift score.

We also filter the competitions, excluding major international events (like the IPF Worlds or EPF Europeans) to concentrate on data from **national competitions**, which better represent the athlete base of a country.

```{r extract-best-performance}
Dati_best <- Dati %>%
  # Excluding international/continental federations to isolate national meets
  filter(!(Federation %in% c("IPF", "EPF", "NAPF", "APF", "NPF", "SAPF",
                             "FESUPO", "OPF", "APL", "CPF"))) %>%
  # Grouping by athlete, weight class, and age class
  group_by(Name, WeightClassKg, AgeClass) %>%
  # For each group, we keep only the row with the highest Goodlift score
  slice_max(Goodlift, n = 1, with_ties = FALSE) %>%
  ungroup()

head(Dati_best)
```

## 1.3 Final Cleaning and Sample Selection

We proceed with further cleaning to ensure the quality and consistency of our analysis sample:
- Remove disqualified athletes ('DQ'). 
- Select only the 'SBD' event (Squat, Bench, Deadlift). 
- Include only the 'Raw' category to ensure comparability.
- Exclude, for interpretability of results, the few observations with Sex not valued within (M,F).
- Remove rows with missing data for the main lifts or Goodlift score. 
- Finally, select only the columns relevant to our analysis.

```{r finishing data cleaning}
D <- Dati_best %>%
  filter(
    Place != 'DQ',
    Event == 'SBD',
    Equipment == 'Raw',
    Sex != 'Mx',
    !is.na(Goodlift),
    !is.na(Best3SquatKg),
    !is.na(Best3BenchKg),
    !is.na(Best3DeadliftKg)
  ) %>%
  select(Name, Sex, Age, WeightClassKg, BodyweightKg, MeetCountry,
         Best3SquatKg, Best3BenchKg, Best3DeadliftKg, TotalKg, Goodlift)

head(D)
```

## 1.4 Creating Percentage Variables

The goal of our analysis is to identify profiles based on an athlete's "structure," not their absolute strength. For this, we create three new variables that express each lift as a **percentage of the total lifted**. This allows us to fairly compare the specialization of a lighter athlete with that of a heavier one.

```{r create-percentages}
DC <- D %>%
  mutate(
    PSquat = (Best3SquatKg / TotalKg) * 100,
    PBench = (Best3BenchKg / TotalKg) * 100,
    PDeads = (Best3DeadliftKg / TotalKg) * 100
  )
# Saving the clean and ready-to-use dataset, so we can load it directly
# in the future without repeating all the steps.
save(DC, file = 'DC.RData')

# Display the first few rows of the final dataset
head(DC)
```

*The DC dataset is now ready. It contains essential demographic and competition information and, most importantly, the three percentage variables (PSquat, PBench, PDeads) that will be the core of our Cluster Analysis.*

------------------------------------------------------------------------

# 2. Descriptive Analysis: The Composition of the Total

To compare athletes fairly, we use the percentage of each lift relative to the total, as calculated in the previous section. We analyze the distribution of these three variables to get an initial idea of the average powerlifter's structure.

```{r descriptive-analysis}

med_squat <- median(DC$PSquat, na.rm = TRUE)
med_bench <- median(DC$PBench, na.rm = TRUE)
med_deads <- median(DC$PDeads, na.rm = TRUE)

p1 <- ggplot(DC, aes(x = PSquat)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black", alpha = 0.8) +
  geom_vline(xintercept = med_squat, linetype = "dashed", color = "gold", linewidth = 1) +
  annotate("text", x = med_squat, y = Inf, label = paste0(round(med_squat, 1), '%'),
           vjust = 1.3, hjust = -0.5, color = "black", size = 4) +
  labs(x = "% Squat", y = NULL) +
  xlim(15, 55) + ylim(0, 50000) + theme_minimal()

p2 <- ggplot(DC, aes(x = PBench)) +
  geom_histogram(binwidth = 1, fill = "#d17d6d", color = "black", alpha = 0.8) +
  geom_vline(xintercept = med_bench, linetype = "dashed", color = "gold", linewidth = 1) +
  annotate("text", x = med_bench, y = Inf, label = paste0(round(med_bench, 1), '%'),
           vjust = 1.3, hjust = -0.5, color = "black", size = 4) +
  labs(x = "% Bench", y = NULL) +
  xlim(15, 55) + ylim(0, 50000) + theme_minimal()

p3 <- ggplot(DC, aes(x = PDeads)) +
  geom_histogram(binwidth = 1, fill = "#69b3a2", color = "black", alpha = 0.8) +
  geom_vline(xintercept = med_deads, linetype = "dashed", color = "gold", linewidth = 1) +
  annotate("text", x = med_deads, y = Inf, label = paste0(round(med_deads, 1), '%'),
           vjust = 1.3, hjust = -0.5, color = "black", size = 4) +
  labs(x = "% Deadlift", y = NULL) +
  xlim(15, 55) + ylim(0, 50000) + theme_minimal()

p1 / p2 / p3
```

*This plot not suprisingly shows that, on average, the deadlift constitutes the largest portion of the total (median \~42%), followed by the squat (\~35.6%) and the bench press (\~22.3%).*

------------------------------------------------------------------------

# 3. Cluster Analysis: Identifying Athlete Profiles

## 3.1. Choosing the Number of Clusters (Combined Approach)

To determine the optimal number of clusters (k), the first step is to use a quantitative method like the "Elbow Method." This method calculates the within-cluster sum of squares (SSE) for different values of K. The "elbow" in the plot, where the SSE stops decreasing rapidly, indicates a good trade-off between the number of clusters and internal compactness.

To make the calculation efficient on such a large dataset, we apply the method to a random sample of 1000 athletes.

```{r elbow-method}
DC_pct <- DC %>% select(PSquat, PBench, PDeads)
DC_scaled <- scale(DC_pct)

set.seed(123)
DC_sample_scaled <- DC_scaled %>% as.data.frame() %>% sample_n(1000)

fviz_nbclust(DC_sample_scaled, kmeans, method = "wss", nstart = 10) +
  labs(title = "Elbow Method for K Selection", x = 'Number of Clusters K', y = 'Within-cluster Sum of Squares (SSE)') +
  theme_minimal()
```

As can be seen from the graph, there is no sharp, unambiguous "elbow." The most drastic decrease in SSE occurs when moving from K=1 to K=2. The transition from K=2 to K=3 also shows a considerable reduction, after which the curve's slope flattens. This suggests that both K=2 and K=3 could be reasonable choices from a purely statistical standpoint. In situations like this, **domain knowledge** is crucial to resolve ambiguity. Since powerlifting is defined by **three distinct disciplines (Squat, Bench Press, Deadlift)**, it makes a great deal of interpretive sense to try to identify three athlete profiles, each potentially specializing in one of these lifts. Therefore, backed by a quantitative indication that does not rule out K=3 and a solid theoretical justification, we choose to proceed with K=3 clusters.

## 3.2. Applying K-Means and Renaming Clusters

We apply the K-Means algorithm with k=3 to the entire dataset and then analyze the cluster means to give them intuitive names.

```{r apply-kmeans}
set.seed(123)
km_full <- kmeans(DC_scaled, centers = 3, nstart = 10)
DC$Cluster <- factor(km_full$cluster)

cluster_summary <- DC %>%
  group_by(Cluster) %>%
  summarise(
    Squat_Mean = mean(PSquat),
    Bench_Mean = mean(PBench),
    Deadlift_Mean = mean(PDeads),
    Num_Athletes = n()
  )
print(cluster_summary)

# We rename the clusters based on the dominant lift to make them more readable
# Note: Cluster numbers might change on each run, so we adapt the names.
# Check the table above to confirm the correct mapping!
DC <- DC %>%
  mutate(Cluster = recode_factor(Cluster,
                                 `1` = "Bp",  # Bench Press dominant
                                 `2` = "Dl",  # Deadlift dominant
                                 `3` = "Sq")) # Squat dominant

# We reorder the levels for consistency in plots
DC$Cluster <- factor(DC$Cluster, levels = c('Sq', 'Bp', 'Dl'))
```

*The table of means confirms the existence of three distinct profiles: a group with a higher-than-average Squat percentage (which we'll call ‘Sq’), one with a dominant Bench Press percentage (‘Bp’), and one specialized in the Deadlift (‘Dl’).*

## 3.3. Cluster Visualization

A ternary plot is perfect for visualizing compositional data like our three percentages. Each point represents an athlete, and its position depends on their lifting structure.

```{r ternary plot}

cluster_levels <- levels(as.factor(DC$Cluster))
auto_colors <- scales::hue_pal()(length(cluster_levels))
names(auto_colors) <- cluster_levels

ggtern(data = DC, aes(x = PBench, y = PDeads, z = PSquat, color = Cluster)) +
  geom_point(alpha = 0.5, size = 1.5) +
  labs(
    title = "Athlete Distribution by Structural Profile",
    x = "% BP",
    y = "% DL",
    z = "% SQ",
    color = "Cluster"
  ) +
  scale_color_manual(values = auto_colors) +
  theme_minimal() + 
  theme(tern.axis.line.T = element_line(color = auto_colors["Dl"]),
    tern.axis.title.T = element_text(color = auto_colors["Dl"]),
    
    tern.axis.line.L = element_line(color = auto_colors["Bp"]),
    tern.axis.title.L = element_text(color = auto_colors["Bp"]),
    
    tern.axis.line.R = element_line(color = auto_colors["Sq"]),
    tern.axis.title.R = element_text(color = auto_colors["Sq"])
  )
```

*This plot clearly shows the three "islands" of density corresponding to the identified clusters, visually confirming the validity of our segmentation. Each corner of the triangle represents an athlete who totals 100% in that specific lift.*

------------------------------------------------------------------------

# 4. Association between Clusters and Nation

Is there a national "specialization"? Do some countries tend to produce more athletes of a certain profile? We use **Correspondence Analysis** to investigate the association between cluster membership and the country of competition.

## 4.1. Country Selection and Association Test

To avoid an overly crowded plot, we filter the dataset to include only the countries with the most athletes, covering about 90% of the observations (37 countries). We then perform a Chi-squared test to check if the association is statistically significant.

```{r country-selection-chisq}
# Select countries covering 90% of observations
country_counts <- as.data.frame(table(DC$MeetCountry)) %>%
  arrange(desc(Freq)) %>%
  mutate(Cumulative_Perc = cumsum(Freq) / sum(Freq))

selected_countries <- country_counts %>%
  filter(Cumulative_Perc <= 0.90) %>%
  pull(Var1)

# Filter the dataset
DC_filtered_countries <- DC %>% filter(MeetCountry %in% selected_countries)

# Create contingency table and test the association
contingency_table <- table(DC_filtered_countries$Cluster, DC_filtered_countries$MeetCountry)
chisq_result <- chisq.test(contingency_table)

print(chisq_result)
```

*The p-value of the Chi-squared test is extremely low (\< 2.2e-16), which allows us to reject the hypothesis of independence. There is a statistically significant association between an athlete's profile and the country in which they compete.*

## 4.2. Correspondence Analysis (CA Biplot)

The Correspondence Analysis biplot graphically displays this relationship. Proximity between a cluster point (blue) and a country point (red) indicates a stronger-than-average association. It's important to note that the two dimensions of the plot explain 100% of the total variance (Dim1: 76.3%, Dim2: 23.7%), so this biplot is a complete and faithful representation.

```{r ca-biplot-final}
res.ca <- CA(contingency_table, graph = FALSE)
fviz_ca_biplot(res.ca, repel = TRUE, title = "Correspondence Analysis between Cluster and Country") +
  theme_minimal()
```

*The biplot reveals very clear geographical patterns. The horizontal axis (Dim1) starkly contrasts the **Deadlifters (Dl)** on the left with the **Benchers (Bp)** on the right. The vertical axis (Dim2) isolates the **Squatters (Sq)** in the upper portion. Key associations emerge:* \* ***'Sq' Cluster (Squatters):*** *Associated with nations like **New Zealand, Netherlands, UK, and Philippines.*** \* ***'Bp' Cluster (Benchers):*** *Shows a strong association with a group of Central and Northern European countries, particularly **Germany, Austria, Poland, and Sweden**. **Russia** appears as an extreme case, heavily skewed towards this profile.* \* ***'Dl' Cluster (Deadlifters):*** *Clearly associated with Latin American countries like **Colombia, Mexico, Brazil, and Argentina.*** \* ***Average Profile:*** *Nations like the **USA, Australia, Canada, and Belgium** are very close to the center, indicating their athlete distribution across the three clusters is very similar to the global average.*

------------------------------------------------------------------------

# 5. Comparing Performance Across Clusters

Which athlete profile is, on average, more successful? We compare **Goodlift Points** (a standardized score accounting for body weight and sex) across the three clusters.

## 5.1. Distribution of GL Points and ANOVA Test

We visualize the distributions of GL Points for each cluster and use an ANOVA test to verify if the differences in means are significant.

```{r anova-gl}
# Calculate means for the vertical lines in the plot
cluster_means <- DC %>%
  group_by(Cluster) %>%
  summarise(mean_goodlift = mean(Goodlift, na.rm = TRUE))

# Density plot
ggplot(DC, aes(x = Goodlift, fill = Cluster)) +
  geom_density(alpha = 0.6) +
  geom_vline(data = cluster_means, aes(xintercept = mean_goodlift, color = Cluster),
             linetype = "dashed", size = 1.2) +
  labs(
    title = "Distribution of Goodlift Points by Cluster",
    x = "Goodlift Points",
    y = "Density"
  ) +
  theme_minimal()

# ANOVA Test
summary(aov(Goodlift ~ Cluster, data = DC))
```

*Visually, the **Benchers (Bp)** cluster appears to have the highest average GL Points. The ANOVA test confirms that the differences between the groups are statistically highly significant (p-value \< 2e-16). This result is counterintuitive, given that the bench press contributes the least to the total.*

## 5.2. Gender Analysis: A Hidden Factor?

The high performance of "Benchers" could be explained by a confounding variable. We investigate the gender composition of the clusters.

```{r gender-analysis-plot}
# Contingency table for gender and cluster
table(DC$Cluster, DC$Sex)

# Separate density plots for Males and Females
p_all <- ggplot(DC, aes(x = Goodlift, fill = Cluster)) +
  geom_density(alpha = 0.6) + labs(title = "Total Population", x = NULL) + theme_minimal()

p_male <- DC %>% filter(Sex == 'M') %>% ggplot(aes(x = Goodlift, fill = Cluster)) +
  geom_density(alpha = 0.6) + labs(title = "Males Only", x = NULL) + theme_minimal()

p_female <- DC %>% filter(Sex == 'F') %>% ggplot(aes(x = Goodlift, fill = Cluster)) +
  geom_density(alpha = 0.6) + labs(title = "Females Only", x = "Goodlift Points") + theme_minimal()

p_all / p_male / p_female + plot_layout(guides = "collect")
```

*The cause is revealed. The table shows that the **Benchers (Bp) cluster is over 90% male**, and males tend to have higher average GL Points. When we analyze the sexes separately, we see that **controlling for gender, the performance differences between clusters drastically decrease or even reverse**. The Deadlifters (Dl) cluster, for instance, has the lowest GL Points in both sexes.*

------------------------------------------------------------------------

# 6. Conclusions

This analysis has allowed us to draw several key conclusions:

1.  **There are three distinct athlete profiles** in powerlifting, characterized by the percentage dominance of one of the three lifts: Squat, Bench Press, or Deadlift.
2.  **Cluster membership is significantly associated with the nation** where the athlete competes, suggesting possible "schools" or specializations at a geographical level.
3.  The **"Benchers" cluster shows the highest GL Points scores**, but this effect is almost entirely explained by a **strong male prevalence** within it (gender gap).
4.  **Controlling for gender**, the **"Deadlifter"** profile proves to be the one with the lowest average performance, while "Squatters" and "Benchers" are equivalent.

This notebook demonstrates how, starting from raw data, it is possible to use clustering and statistical analysis techniques to uncover hidden patterns and tell a complex and multi-faceted story.
